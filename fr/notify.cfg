[gcode_macro _NOTIFY]
gcode:
    {% set msg = params.MSG|default("Ok")|string %}

    {action_call_remote_method("notify",
                             name="notifier",
                             message=msg)}

[gcode_shell_command update_notify]
command: /opt/config/mod_data/plugins/notify/update_notify.sh
timeout: 7200
verbose: False

[delayed_gcode _UPDATE_NOTIFY]
initial_duration: 3
gcode:
    RUN_SHELL_COMMAND CMD=update_notify PARAMS=0

[gcode_macro UPDATE_NOTIFY]
gcode:
    RUN_SHELL_COMMAND CMD=update_notify PARAMS=1
    REBOOT
